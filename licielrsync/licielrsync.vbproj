<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <Platform Condition=" '$(Platform)' == '' ">x86</Platform>
    <ProductVersion>
    </ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{6066CDA1-BDDB-43B7-BE5B-9281DAFFC5B3}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <StartupObject>Sub Main</StartupObject>
    <RootNamespace>licielrsync</RootNamespace>
    <AssemblyName>licielrsync</AssemblyName>
    <FileAlignment>512</FileAlignment>
    <MyType>WindowsFormsWithCustomSubMain</MyType>
    <TargetFrameworkVersion>v2.0</TargetFrameworkVersion>
    <IsWebBootstrapper>false</IsWebBootstrapper>
    <TargetFrameworkProfile>
    </TargetFrameworkProfile>
    <PublishUrl>publish\</PublishUrl>
    <Install>true</Install>
    <InstallFrom>Disk</InstallFrom>
    <UpdateEnabled>false</UpdateEnabled>
    <UpdateMode>Foreground</UpdateMode>
    <UpdateInterval>7</UpdateInterval>
    <UpdateIntervalUnits>Days</UpdateIntervalUnits>
    <UpdatePeriodically>false</UpdatePeriodically>
    <UpdateRequired>false</UpdateRequired>
    <MapFileExtensions>true</MapFileExtensions>
    <ApplicationRevision>0</ApplicationRevision>
    <ApplicationVersion>1.0.0.0</ApplicationVersion>
    <UseApplicationTrust>false</UseApplicationTrust>
    <PublishWizardCompleted>true</PublishWizardCompleted>
    <BootstrapperEnabled>true</BootstrapperEnabled>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|x86' ">
    <PlatformTarget>x86</PlatformTarget>
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <DefineDebug>true</DefineDebug>
    <DefineTrace>true</DefineTrace>
    <OutputPath>bin\Debug\</OutputPath>
    <DocumentationFile>
    </DocumentationFile>
    <NoWarn>42016,41999,42017,42018,42019,42032,42036,42020,42021,42022</NoWarn>
    <UseVSHostingProcess>false</UseVSHostingProcess>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|x86' ">
    <PlatformTarget>x86</PlatformTarget>
    <DebugType>None</DebugType>
    <DefineDebug>false</DefineDebug>
    <DefineTrace>true</DefineTrace>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DocumentationFile>
    </DocumentationFile>
    <NoWarn>42016,41999,42017,42018,42019,42032,42036,42020,42021,42022</NoWarn>
    <UseVSHostingProcess>false</UseVSHostingProcess>
    <RemoveIntegerChecks>false</RemoveIntegerChecks>
    <DebugSymbols>false</DebugSymbols>
    <GenerateSerializationAssemblies>Auto</GenerateSerializationAssemblies>
  </PropertyGroup>
  <PropertyGroup>
    <OptionExplicit>On</OptionExplicit>
  </PropertyGroup>
  <PropertyGroup>
    <OptionCompare>Binary</OptionCompare>
  </PropertyGroup>
  <PropertyGroup>
    <OptionStrict>Off</OptionStrict>
  </PropertyGroup>
  <PropertyGroup>
    <OptionInfer>On</OptionInfer>
  </PropertyGroup>
  <PropertyGroup>
    <ApplicationIcon>images\licielrsync.ico</ApplicationIcon>
  </PropertyGroup>
  <PropertyGroup>
    <SignAssembly>false</SignAssembly>
  </PropertyGroup>
  <PropertyGroup>
    <AssemblyOriginatorKeyFile>
    </AssemblyOriginatorKeyFile>
  </PropertyGroup>
  <PropertyGroup />
  <PropertyGroup>
    <GenerateManifests>false</GenerateManifests>
  </PropertyGroup>
  <PropertyGroup>
    <SignManifests>false</SignManifests>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Windows.Forms" />
  </ItemGroup>
  <ItemGroup>
    <Import Include="licielrsync.My.Resources" />
    <Import Include="Microsoft.VisualBasic" />
    <Import Include="System" />
    <Import Include="System.Collections" />
    <Import Include="System.Collections.Generic" />
    <Import Include="System.Drawing" />
    <Import Include="System.Diagnostics" />
    <Import Include="System.Windows.Forms" />
  </ItemGroup>
  <ItemGroup>
    <Compile Include="ClassMessages.vb" />
    <Compile Include="ClassWin32Api.vb" />
    <Compile Include="ModuleVbMsilReader.vb" />
    <Compile Include="FrameAboutBox.Designer.vb">
      <DependentUpon>FrameAboutBox.vb</DependentUpon>
    </Compile>
    <Compile Include="FrameAboutBox.vb">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="FrameMain.vb">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="FrameMain.Designer.vb">
      <DependentUpon>FrameMain.vb</DependentUpon>
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="FramePasswordPrompt.Designer.vb">
      <DependentUpon>FramePasswordPrompt.vb</DependentUpon>
    </Compile>
    <Compile Include="FramePasswordPrompt.vb">
      <SubType>Form</SubType>
    </Compile>
    <Compile Include="ModuleMain.vb" />
    <Compile Include="ModuleProcess.vb" />
    <Compile Include="ModuleTaskbarWin7.vb" />
    <Compile Include="My Project\AssemblyInfo.vb" />
    <Compile Include="My Project\Resources.Designer.vb">
      <AutoGen>True</AutoGen>
      <DesignTime>True</DesignTime>
      <DependentUpon>Resources.resx</DependentUpon>
    </Compile>
    <Compile Include="ModuleSettings.vb" />
    <Compile Include="My Project\Settings.Designer.vb">
      <AutoGen>True</AutoGen>
      <DesignTimeSharedInput>True</DesignTimeSharedInput>
      <DependentUpon>Settings.settings</DependentUpon>
    </Compile>
  </ItemGroup>
  <ItemGroup>
    <EmbeddedResource Include="FrameAboutBox.resx">
      <DependentUpon>FrameAboutBox.vb</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="FrameMain.fr.resx">
      <DependentUpon>FrameMain.vb</DependentUpon>
      <SubType>Designer</SubType>
      <CustomToolNamespace>My.Resources</CustomToolNamespace>
    </EmbeddedResource>
    <EmbeddedResource Include="FrameMain.resx">
      <DependentUpon>FrameMain.vb</DependentUpon>
      <SubType>Designer</SubType>
      <CustomToolNamespace>My.Resources</CustomToolNamespace>
    </EmbeddedResource>
    <EmbeddedResource Include="FramePasswordPrompt.fr.resx">
      <DependentUpon>FramePasswordPrompt.vb</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="FramePasswordPrompt.resx">
      <DependentUpon>FramePasswordPrompt.vb</DependentUpon>
    </EmbeddedResource>
    <EmbeddedResource Include="My Project\Resources.fr.resx">
      <CustomToolNamespace>My.Resources</CustomToolNamespace>
    </EmbeddedResource>
    <EmbeddedResource Include="My Project\Resources.resx">
      <Generator>VbMyResourcesResXFileCodeGenerator</Generator>
      <LastGenOutput>Resources.Designer.vb</LastGenOutput>
      <CustomToolNamespace>My.Resources</CustomToolNamespace>
      <SubType>Designer</SubType>
    </EmbeddedResource>
  </ItemGroup>
  <ItemGroup>
    <None Include="app.config">
      <LastGenOutput>app.Designer.vb</LastGenOutput>
    </None>
    <None Include="My Project\Settings.settings">
      <Generator>SettingsSingleFileGenerator</Generator>
      <CustomToolNamespace>My</CustomToolNamespace>
      <LastGenOutput>Settings.Designer.vb</LastGenOutput>
    </None>
    <None Include="pub.adovi.128-Bit-DER.cer" />
  </ItemGroup>
  <ItemGroup>
    <None Include="images\bargrad.png" />
    <None Include="images\bargradb.png" />
    <None Include="images\famfamfam_silk_icons_v013\clock.png" />
    <Content Include="images\licielrsync.ico" />
  </ItemGroup>
  <ItemGroup>
    <BootstrapperPackage Include="Microsoft.Net.Client.3.5">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1 Client Profile</ProductName>
      <Install>false</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Net.Framework.3.5.SP1">
      <Visible>False</Visible>
      <ProductName>.NET Framework 3.5 SP1</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
    <BootstrapperPackage Include="Microsoft.Windows.Installer.3.1">
      <Visible>False</Visible>
      <ProductName>Windows Installer 3.1</ProductName>
      <Install>true</Install>
    </BootstrapperPackage>
  </ItemGroup>
  <ItemGroup />
  <Import Project="$(MSBuildToolsPath)\Microsoft.VisualBasic.targets" />
  <ProjectExtensions>
    <VisualStudio>
      <UserProperties BuildVersion_UpdateAssemblyVersion="True" BuildVersion_ConfigurationName="Release" BuildVersion_BuildVersioningStyle="None.None.None.Increment" BuildVersion_StartDate="2012/2/6" />
    </VisualStudio>
  </ProjectExtensions>
  <PropertyGroup>
  </PropertyGroup>
  <Target Name="AfterBuild">
    <Message Text="===============================================================================[POSTBUILD - RSYNC]==" />
    <Message Text="                 Copying rsync from the original folder to the distribution folder" />
    <Message Text="====================================================================================================" />
    <Exec Command="robocopy %22$(ProjectDir)redist\rsync%22 %22$(TargetDir)\%22 /E /XD .svn" ContinueOnError="True" IgnoreExitCode="True">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Exec>
    <Error Text="Robocopy not found. On Windows XP/2003 install this package http://www.microsoft.com/download/en/details.aspx?id=17657" Condition="'$(ExitCode)' == '9009'" />
    <Error Text="Error while copying rsync from the original folder to the distribution folder (robocopy)." Condition="'$(ExitCode)' != '2' And '$(ExitCode)' != '3'" />
    <Message Text="==============================================================================[POSTBUILD - CYGWIN]==" />
    <Message Text="                 Copying cygwin from the original folder to the distribution folder" />
    <Message Text="====================================================================================================" />
    <Exec Command="FOR /F %22tokens=*%22 %25%25G in ('dir /ad /s /b %22$(TargetDir)*bin*%22') DO robocopy %22$(ProjectDir)redist\cygwin%22 %22%25%25G%22 /E /XD .svn" ContinueOnError="True" IgnoreExitCode="True">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Exec>
    <Error Text="Robocopy not found. On Windows XP/2003 install this package http://www.microsoft.com/download/en/details.aspx?id=17657" Condition="'$(ExitCode)' == '9009'" />
    <Error Text="Error while copying cygwin from the original folder to the distribution folder (robocopy)." Condition="'$(ExitCode)' != '2' And '$(ExitCode)' != '3'" />
    <CallTarget Targets="PackageDebug" Condition="'$(Configuration)' == 'Debug'" />
    <CallTarget Targets="PackageRelease" Condition="'$(Configuration)' == 'Release'" />
  </Target>
  <Target Name="PackageDebug" Condition="'$(Configuration)' == 'Debug'">
    <Message Text="===============================================================================[POSTBUILD - RSYNC]==" />
    <Message Text="                 Copying rsync test files from the original folder to the debug folder" />
    <Message Text="====================================================================================================" />
    <Exec Command="robocopy %22$(ProjectDir)redist\tests%22 %22$(TargetDir)\%22 /E /XD .svn" ContinueOnError="True" IgnoreExitCode="True">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Exec>
    <Error Text="Robocopy not found. On Windows XP/2003 install this package http://www.microsoft.com/download/en/details.aspx?id=17657" Condition="'$(ExitCode)' == '9009'" />
    <Error Text="Error while copying rsync test files from the original folder to the debug folder (robocopy)." Condition="'$(ExitCode)' != '2' And '$(ExitCode)' != '3'" />
  </Target>
  <Target Name="PackageRelease" Condition="'$(Configuration)' == 'Release'">
    <GetAssemblyIdentity AssemblyFiles="$(TargetPath)">
      <Output TaskParameter="Assemblies" ItemName="CurrentAssembly" />
    </GetAssemblyIdentity>
    <Message Text="========================================================================[POSTBUILD - CODE SIGNING]==" />
    <Message Text="                    Signing the executable (reserved to Arnaud Dovi only)" />
    <Message Text="====================================================================================================" />
    <Exec Command="start /WAIT %22licielrsync code signing%22 cmd /V:ON /K %22set /P __LICIELRSYNCCERTSTORE=Please enter the store name containing the private key : &amp;&amp; %22C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\signtool.exe%22 sign /f %22$(ProjectDir)pub.adovi.128-Bit-DER.cer%22 /csp %22Microsoft Strong Cryptographic Provider%22 /v /kc %22!__LICIELRSYNCCERTSTORE!%22 /t %22http://timestamp.verisign.com/scripts/timstamp.dll%22 %22$(TargetDir)licielrsync.exe%22 &amp;&amp; pause &amp;&amp; exit 0%22" ContinueOnError="True" IgnoreExitCode="True">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Exec>
    <Error Text="Error while signing the executable with a digital authenticode certificate (this procedure is reserved to Arnaud Dovi). Change the project to the Debug configuration and rebuild the project." Condition="'$(ExitCode)' != '0'" />
    <Message Text="========================================================================[POSTBUILD - CODE SIGNING]==" />
    <Message Text="                               Publishing release with 7-Zip" />
    <Message Text="====================================================================================================" />
    <ItemGroup>
      <MySourceFiles Include="$(TargetDir)**\*.*" />
    </ItemGroup>
    <Copy SourceFiles="@(MySourceFiles)" DestinationFiles="@(MySourceFiles->'$(ProjectDir)bin\Temp\licielrsync\%(RecursiveDir)%(Filename)%(Extension)')" />
    <Exec Command="%22$(ProjectDir)redist\7z.exe%22 a -t7z -r -mx9 -mmt -ms=on %22$(ProjectDir)redist\%(CurrentAssembly.Name)-%(CurrentAssembly.Version).7z%22 %22$(ProjectDir)bin\Temp\licielrsync%22" ContinueOnError="True" IgnoreExitCode="True">
      <Output TaskParameter="ExitCode" PropertyName="ExitCode" />
    </Exec>
    <Error Text="7z.exe not found." Condition="'$(ExitCode)' == '9009'" />
    <Error Text="Error with 7-Zip while publishing the release." Condition="'$(ExitCode)' != '0'" />
    <RemoveDir Directories="$(ProjectDir)bin\Temp" />
    <Message Text="====================================================================================================" />
    <Message Text="                                        BUILD SUCCESS !" />
    <Message Text="====================================================================================================" />
  </Target>
  <Target Name="AfterClean">
    <RemoveDir Directories="$(TargetDir);" />
  </Target>
</Project>
<!-- <PostBuildEvent>
robocopy "$(ProjectDir)redist\rsync" "$(TargetDir)\" /E /XD .svn
if errorlevel 4 goto error
FOR /D /r %25%25G in (*bin) DO robocopy "$(ProjectDir)redist\cygwin" "%25%25G" /E /XD .svn
if errorlevel 4 goto error
if "$(ConfigurationName)" == "Debug" exit 0
start /WAIT "licielrsync code signing" cmd /V:ON /K "set /P __LICIELRSYNCCERTSTORE=Please enter the store name containing the private key : &amp;&amp; "C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Bin\signtool.exe" sign /f "$(ProjectDir)pub.adovi.128-Bit-DER.cer" /csp "Microsoft Strong Cryptographic Provider" /v /kc "!__LICIELRSYNCCERTSTORE!" /t "http://timestamp.verisign.com/scripts/timstamp.dll" "$(TargetDir)licielrsync.exe" &amp;&amp; pause &amp;&amp; exit 0"
if errorlevel 4 goto error
exit 0
:error
REM http://timestamp.comodoca.com/authenticode
REM http://timestamp.verisign.com/scripts/timstamp.dll</PostBuildEvent>-->